(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function r(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=r(e);fetch(e.href,t)}})();document.addEventListener("DOMContentLoaded",()=>{const o=document.getElementById("crud-content");document.querySelectorAll(".crud-actions button").forEach(r=>{r.addEventListener("click",async a=>{const e=r.getAttribute("data-entity"),t=r.getAttribute("data-action");o.innerHTML="",e==="produtos"&&t==="listar"?await n():o.innerHTML=`<p style="text-align:center;">Funcionalidade <b>${t}</b> para <b>${e}</b> em construção.</p>`})});async function n(){const r=localStorage.getItem("token");try{const a=await fetch("https://store-management-system-xemr.onrender.com/api/produtos",{headers:{Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error("Erro ao buscar produtos");const e=await a.json();if(!Array.isArray(e)||e.length===0){o.innerHTML="<p>Nenhum produto encontrado.</p>";return}let t='<h2>Lista de Produtos</h2><table style="width:100%;border-collapse:collapse;margin-top:1rem;">';t+="<tr><th>ID</th><th>Nome</th><th>Preço</th></tr>",e.forEach(s=>{t+=`<tr><td>${s.id}</td><td>${s.nome}</td><td>${s.preco}</td></tr>`}),t+="</table>",o.innerHTML=t}catch{o.innerHTML='<p style="color:red;">Erro ao buscar produtos.</p>'}}});document.getElementById("logout-btn").addEventListener("click",async()=>{const o=localStorage.getItem("token");if(!o){window.location.href="login.html";return}try{const r=await(await fetch("https://store-management-system-xemr.onrender.com/api/auth/logout",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}})).json();alert(r.message||"Logout realizado!")}catch{alert(data.message||"Erro ao efetuar logout.")}localStorage.removeItem("token"),window.location.href="login.html"});
